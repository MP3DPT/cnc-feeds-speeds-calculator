<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CNC Feeds & Speeds Calculator</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // SVG Icons
        const Calculator = ({ className = "w-6 h-6" }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <rect x="4" y="2" width="16" height="20" rx="2"></rect>
                <line x1="8" y1="6" x2="16" y2="6"></line>
            </svg>
        );

        const Settings = ({ className = "w-6 h-6" }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="3"></circle>
                <path d="M12 1v6m0 6v6"></path>
            </svg>
        );

        const Database = ({ className = "w-6 h-6" }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <ellipse cx="12" cy="5" rx="9" ry="3"></ellipse>
                <path d="M3 5v14c0 1.66 4 3 9 3s9-1.34 9-3V5"></path>
            </svg>
        );

        const Save = ({ className = "w-6 h-6" }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <path d="M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"></path>
            </svg>
        );

        const Trash2 = ({ className = "w-6 h-6" }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <polyline points="3 6 5 6 21 6"></polyline>
                <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"></path>
            </svg>
        );

        const Info = ({ className = "w-6 h-6" }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <circle cx="12" cy="12" r="10"></circle>
                <line x1="12" y1="16" x2="12" y2="12"></line>
                <line x1="12" y1="8" x2="12.01" y2="8"></line>
            </svg>
        );

        const Plus = ({ className = "w-6 h-6" }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <line x1="12" y1="5" x2="12" y2="19"></line>
                <line x1="5" y1="12" x2="19" y2="12"></line>
            </svg>
        );

        const Edit2 = ({ className = "w-6 h-6" }) => (
            <svg className={className} fill="none" stroke="currentColor" strokeWidth="2" viewBox="0 0 24 24">
                <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>
            </svg>
        );

        // Storage wrapper
        window.storage = {
            async get(key) {
                const value = localStorage.getItem(key);
                return value ? { value } : null;
            },
            async set(key, value) {
                localStorage.setItem(key, value);
                return { key, value };
            }
        };

        const App = () => {
            const [activeTab, setActiveTab] = useState('machines');
            const [machines, setMachines] = useState([]);
            const [bits, setBits] = useState([]);
            const [selectedMachine, setSelectedMachine] = useState(null);
            const [selectedBit, setSelectedBit] = useState(null);
            const [material, setMaterial] = useState('softwood');
            const [depthOfCut, setDepthOfCut] = useState(1);
            const [results, setResults] = useState(null);
            const [notification, setNotification] = useState(null);
            const [showExportModal, setShowExportModal] = useState(false);
            const [showImportModal, setShowImportModal] = useState(false);
            const [exportedData, setExportedData] = useState('');

            const materials = {
                softwood: { name: 'Softwood (Pine, Cedar)', chipLoad: 0.15 },
                hardwood: { name: 'Hardwood (Oak, Maple)', chipLoad: 0.10 },
                plywood: { name: 'Plywood', chipLoad: 0.12 },
                mdf: { name: 'MDF', chipLoad: 0.13 },
                acrylic: { name: 'Acrylic', chipLoad: 0.08 },
                aluminum: { name: 'Aluminum', chipLoad: 0.05 },
                foam: { name: 'Foam', chipLoad: 0.20 },
            };

            useEffect(() => {
                loadData();
            }, []);

            const showNotification = (message, type = 'success') => {
                setNotification({ message, type });
                setTimeout(() => setNotification(null), 4000);
            };

            const loadData = async () => {
                try {
                    const mr = await window.storage.get('cnc_machines');
                    if (mr?.value) {
                        const m = JSON.parse(mr.value);
                        setMachines(m);
                        if (m.length > 0) setSelectedMachine(m[0]);
                    }
                } catch (e) {}

                try {
                    const br = await window.storage.get('cnc_bits');
                    if (br?.value) {
                        const b = JSON.parse(br.value);
                        setBits(b);
                        if (b.length > 0) setSelectedBit(b[0]);
                    }
                } catch (e) {}
            };

            const saveMachinesData = async (updated) => {
                try {
                    await window.storage.set('cnc_machines', JSON.stringify(updated));
                    setMachines(updated);
                    showNotification('Machine saved!');
                } catch (e) {
                    showNotification('Error saving', 'error');
                }
            };

            const saveBitsData = async (updated) => {
                try {
                    await window.storage.set('cnc_bits', JSON.stringify(updated));
                    setBits(updated);
                    showNotification('Bit saved!');
                } catch (e) {
                    showNotification('Error saving', 'error');
                }
            };

            const addMachine = (m) => {
                const newM = { ...m, id: Date.now() };
                const updated = [...machines, newM];
                saveMachinesData(updated);
                setSelectedMachine(newM);
            };

            const updateMachine = (m) => {
                const updated = machines.map(x => x.id === m.id ? m : x);
                saveMachinesData(updated);
                if (selectedMachine?.id === m.id) setSelectedMachine(m);
            };

            const deleteMachine = (id) => {
                const updated = machines.filter(m => m.id !== id);
                saveMachinesData(updated);
                if (selectedMachine?.id === id) {
                    setSelectedMachine(updated.length > 0 ? updated[0] : null);
                }
            };

            const addBit = (b) => {
                const newB = { ...b, id: Date.now() };
                const updated = [...bits, newB];
                saveBitsData(updated);
                setSelectedBit(newB);
            };

            const updateBit = (b) => {
                const updated = bits.map(x => x.id === b.id ? b : x);
                saveBitsData(updated);
                if (selectedBit?.id === b.id) setSelectedBit(b);
            };

            const deleteBit = (id) => {
                const updated = bits.filter(b => b.id !== id);
                saveBitsData(updated);
                if (selectedBit?.id === id) {
                    setSelectedBit(updated.length > 0 ? updated[0] : null);
                }
            };

            const exportData = () => {
                const data = { machines, bits, exportDate: new Date().toISOString(), version: '1.0' };
                setExportedData(JSON.stringify(data, null, 2));
                setShowExportModal(true);
            };

            const handleImport = (json) => {
                try {
                    const data = JSON.parse(json);
                    if (data.machines) saveMachinesData(data.machines);
                    if (data.bits) saveBitsData(data.bits);
                    showNotification('Imported successfully!');
                    setShowImportModal(false);
                } catch (e) {
                    showNotification('Invalid JSON', 'error');
                }
            };

            const calculate = () => {
                if (!selectedMachine || !selectedBit) return;

                const mat = materials[material];
                const rpm = Math.min(selectedMachine.maxRPM, selectedMachine.optimalRPM);
                
                let chipLoad = mat.chipLoad;
                if (selectedBit.diameter < 3) chipLoad *= 0.7;
                else if (selectedBit.diameter < 6) chipLoad *= 0.85;
                
                const feedRate = rpm * selectedBit.flutes * chipLoad;
                const rigidityFactor = selectedMachine.rigidity === 'high' ? 1.0 : 
                                      selectedMachine.rigidity === 'medium' ? 0.75 : 0.5;
                const adjustedFeedRate = feedRate * rigidityFactor;
                const stepover = selectedBit.diameter * 0.45;
                const maxDepth = selectedBit.diameter * 0.5;
                const mrr = (adjustedFeedRate * depthOfCut * stepover) / 1000;

                const warnings = [];
                if (depthOfCut > maxDepth) warnings.push('‚ö†Ô∏è Depth exceeds maximum');
                if (adjustedFeedRate > selectedMachine.maxFeedRate) warnings.push('‚ö†Ô∏è Feed rate too high');
                if (selectedMachine.rigidity === 'low') warnings.push('üí° Use shallow passes');

                setResults({
                    rpm: Math.round(rpm),
                    feedRate: Math.round(adjustedFeedRate),
                    chipLoad: chipLoad.toFixed(3),
                    stepover: stepover.toFixed(2),
                    maxDepth: maxDepth.toFixed(2),
                    mrr: mrr.toFixed(2),
                    warnings
                });
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 p-4">
                    <div className="max-w-6xl mx-auto">
                        <div className="text-center mb-8 pt-6">
                            <h1 className="text-5xl font-bold text-white mb-2 flex items-center justify-center gap-3">
                                <Calculator className="w-12 h-12" />
                                CNC Feeds & Speeds Calculator
                            </h1>
                            <p className="text-blue-200 text-lg">For DIY CNC Enthusiasts</p>
                        </div>

                        {notification && (
                            <div className={`fixed top-4 right-4 z-50 p-4 rounded-lg shadow-lg ${
                                notification.type === 'success' ? 'bg-green-500' : 'bg-red-500'
                            } text-white font-semibold`}>
                                {notification.message}
                            </div>
                        )}

                        {showExportModal && (
                            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                                <div className="bg-white rounded-lg p-6 max-w-2xl w-full">
                                    <h2 className="text-2xl font-bold mb-4">Export Data</h2>
                                    <textarea
                                        value={exportedData}
                                        readOnly
                                        onClick={(e) => e.target.select()}
                                        className="w-full h-64 p-3 border-2 rounded font-mono text-sm"
                                    />
                                    <div className="mt-4 flex gap-3">
                                        <button
                                            onClick={() => {
                                                navigator.clipboard.writeText(exportedData);
                                                showNotification('Copied!');
                                            }}
                                            className="px-6 py-2 bg-blue-600 text-white rounded-lg"
                                        >
                                            Copy
                                        </button>
                                        <button
                                            onClick={() => setShowExportModal(false)}
                                            className="px-6 py-2 bg-gray-400 text-white rounded-lg"
                                        >
                                            Close
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}

                        {showImportModal && (
                            <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4">
                                <div className="bg-white rounded-lg p-6 max-w-2xl w-full">
                                    <h2 className="text-2xl font-bold mb-4">Import Data</h2>
                                    <textarea
                                        id="importBox"
                                        placeholder="Paste JSON here..."
                                        className="w-full h-64 p-3 border-2 rounded font-mono text-sm"
                                    />
                                    <div className="mt-4 flex gap-3">
                                        <button
                                            onClick={() => handleImport(document.getElementById('importBox').value)}
                                            className="px-6 py-2 bg-green-600 text-white rounded-lg"
                                        >
                                            Import
                                        </button>
                                        <button
                                            onClick={() => setShowImportModal(false)}
                                            className="px-6 py-2 bg-gray-400 text-white rounded-lg"
                                        >
                                            Cancel
                                        </button>
                                    </div>
                                </div>
                            </div>
                        )}

                        <div className="flex gap-2 mb-6 flex-wrap">
                            <button
                                onClick={() => setActiveTab('calculator')}
                                className={`flex items-center gap-2 px-6 py-3 rounded-t-lg font-semibold ${
                                    activeTab === 'calculator' ? 'bg-white text-blue-900' : 'bg-blue-800 text-white'
                                }`}
                            >
                                <Calculator className="w-5 h-5" />
                                Calculator
                            </button>
                            <button
                                onClick={() => setActiveTab('machines')}
                                className={`flex items-center gap-2 px-6 py-3 rounded-t-lg font-semibold ${
                                    activeTab === 'machines' ? 'bg-white text-blue-900' : 'bg-blue-800 text-white'
                                }`}
                            >
                                <Settings className="w-5 h-5" />
                                Machines
                            </button>
                            <button
                                onClick={() => setActiveTab('bits')}
                                className={`flex items-center gap-2 px-6 py-3 rounded-t-lg font-semibold ${
                                    activeTab === 'bits' ? 'bg-white text-blue-900' : 'bg-blue-800 text-white'
                                }`}
                            >
                                <Database className="w-5 h-5" />
                                Bits
                            </button>
                            
                            <div className="ml-auto flex gap-2">
                                <button
                                    onClick={exportData}
                                    className="px-4 py-3 bg-purple-600 text-white rounded-lg flex items-center gap-2"
                                >
                                    <Save className="w-5 h-5" />
                                    Export
                                </button>
                                <button
                                    onClick={() => setShowImportModal(true)}
                                    className="px-4 py-3 bg-orange-600 text-white rounded-lg flex items-center gap-2"
                                >
                                    <Database className="w-5 h-5" />
                                    Import
                                </button>
                            </div>
                        </div>

                        <div className="bg-white rounded-lg shadow-2xl p-8">
                            {activeTab === 'calculator' && (
                                <CalculatorTab
                                    machines={machines}
                                    bits={bits}
                                    selectedMachine={selectedMachine}
                                    setSelectedMachine={setSelectedMachine}
                                    selectedBit={selectedBit}
                                    setSelectedBit={setSelectedBit}
                                    material={material}
                                    setMaterial={setMaterial}
                                    materials={materials}
                                    depthOfCut={depthOfCut}
                                    setDepthOfCut={setDepthOfCut}
                                    calculate={calculate}
                                    results={results}
                                />
                            )}
                            {activeTab === 'machines' && (
                                <MachinesTab
                                    machines={machines}
                                    addMachine={addMachine}
                                    updateMachine={updateMachine}
                                    deleteMachine={deleteMachine}
                                />
                            )}
                            {activeTab === 'bits' && (
                                <BitsTab
                                    bits={bits}
                                    addBit={addBit}
                                    updateBit={updateBit}
                                    deleteBit={deleteBit}
                                />
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        const CalculatorTab = ({ machines, bits, selectedMachine, setSelectedMachine, selectedBit, setSelectedBit, material, setMaterial, materials, depthOfCut, setDepthOfCut, calculate, results }) => {
            if (machines.length === 0 || bits.length === 0) {
                return (
                    <div className="text-center py-12">
                        <Info className="w-16 h-16 mx-auto text-blue-500 mb-4" />
                        <h3 className="text-2xl font-bold mb-2">Get Started</h3>
                        <p className="text-gray-600">Add at least one machine and one bit to calculate.</p>
                    </div>
                );
            }

            return (
                <div className="space-y-6">
                    <div className="grid md:grid-cols-2 gap-6">
                        <div>
                            <label className="block font-semibold mb-2">Machine</label>
                            <select
                                value={selectedMachine?.id || ''}
                                onChange={(e) => setSelectedMachine(machines.find(m => m.id === parseInt(e.target.value)))}
                                className="w-full px-4 py-3 border-2 rounded-lg"
                            >
                                {machines.map(m => (
                                    <option key={m.id} value={m.id}>{m.name}</option>
                                ))}
                            </select>
                        </div>
                        <div>
                            <label className="block font-semibold mb-2">Bit</label>
                            <select
                                value={selectedBit?.id || ''}
                                onChange={(e) => setSelectedBit(bits.find(b => b.id === parseInt(e.target.value)))}
                                className="w-full px-4 py-3 border-2 rounded-lg"
                            >
                                {bits.map(b => (
                                    <option key={b.id} value={b.id}>{b.name}</option>
                                ))}
                            </select>
                        </div>
                    </div>

                    <div>
                        <label className="block font-semibold mb-2">Material</label>
                        <select
                            value={material}
                            onChange={(e) => setMaterial(e.target.value)}
                            className="w-full px-4 py-3 border-2 rounded-lg"
                        >
                            {Object.entries(materials).map(([k, m]) => (
                                <option key={k} value={k}>{m.name}</option>
                            ))}
                        </select>
                    </div>

                    <div>
                        <label className="block font-semibold mb-2">Depth of Cut: {depthOfCut}mm</label>
                        <input
                            type="range"
                            min="0.5"
                            max="10"
                            step="0.5"
                            value={depthOfCut}
                            onChange={(e) => setDepthOfCut(parseFloat(e.target.value))}
                            className="w-full"
                        />
                    </div>

                    <button
                        onClick={calculate}
                        className="w-full py-4 bg-blue-600 text-white text-lg font-bold rounded-lg"
                    >
                        Calculate
                    </button>

                    {results && (
                        <div className="p-6 bg-green-50 rounded-lg border-2 border-green-200">
                            <h3 className="text-2xl font-bold mb-4">Results</h3>
                            <div className="grid md:grid-cols-3 gap-4">
                                <div className="bg-white p-4 rounded-lg">
                                    <div className="text-sm text-gray-600">RPM</div>
                                    <div className="text-3xl font-bold text-blue-600">{results.rpm}</div>
                                </div>
                                <div className="bg-white p-4 rounded-lg">
                                    <div className="text-sm text-gray-600">Feed Rate</div>
                                    <div className="text-3xl font-bold text-green-600">{results.feedRate}</div>
                                    <div className="text-sm">mm/min</div>
                                </div>
                                <div className="bg-white p-4 rounded-lg">
                                    <div className="text-sm text-gray-600">Chip Load</div>
                                    <div className="text-3xl font-bold text-purple-600">{results.chipLoad}</div>
                                    <div className="text-sm">mm/tooth</div>
                                </div>
                            </div>
                            {results.warnings.length > 0 && (
                                <div className="mt-4 p-4 bg-yellow-50 rounded">
                                    {results.warnings.map((w, i) => (
                                        <div key={i} className="text-yellow-800">{w}</div>
                                    ))}
                                </div>
                            )}
                        </div>
                    )}
                </div>
            );
        };

        const MachinesTab = ({ machines, addMachine, updateMachine, deleteMachine }) => {
            const [showForm, setShowForm] = useState(false);
            const [editing, setEditing] = useState(null);
            const [form, setForm] = useState({
                name: '', maxRPM: 24000, optimalRPM: 18000, maxFeedRate: 3000,
                rigidity: 'medium', spindleType: 'router', motorType: 'stepper'
            });

            const handleSubmit = () => {
                if (!form.name) return;
                if (editing) {
                    updateMachine({ ...form, id: editing.id });
                    setEditing(null);
                } else {
                    addMachine(form);
                }
                setForm({ name: '', maxRPM: 24000, optimalRPM: 18000, maxFeedRate: 3000,
                         rigidity: 'medium', spindleType: 'router', motorType: 'stepper' });
                setShowForm(false);
            };

            const handleEdit = (m) => {
                setForm(m);
                setEditing(m);
                setShowForm(true);
            };

            return (
                <div>
                    <div className="flex justify-between mb-6">
                        <h2 className="text-2xl font-bold">My Machines</h2>
                        <button
                            onClick={() => setShowForm(!showForm)}
                            className="px-6 py-2 bg-blue-600 text-white rounded-lg flex items-center gap-2"
                        >
                            <Plus className="w-5 h-5" />
                            {showForm ? 'Cancel' : 'Add Machine'}
                        </button>
                    </div>

                    {showForm && (
                        <div className="mb-6 p-6 bg-gray-50 rounded-lg">
                            <h3 className="font-bold mb-4">{editing ? 'Edit' : 'Add'} Machine</h3>
                            <div className="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">Machine Name *</label>
                                    <input
                                        placeholder="My DIY CNC Router"
                                        value={form.name}
                                        onChange={(e) => setForm({...form, name: e.target.value})}
                                        className="w-full px-4 py-2 border-2 rounded-lg"
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">Max RPM</label>
                                    <input
                                        type="number"
                                        placeholder="24000"
                                        value={form.maxRPM}
                                        onChange={(e) => setForm({...form, maxRPM: parseInt(e.target.value)})}
                                        className="w-full px-4 py-2 border-2 rounded-lg"
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">Optimal RPM</label>
                                    <input
                                        type="number"
                                        placeholder="18000"
                                        value={form.optimalRPM}
                                        onChange={(e) => setForm({...form, optimalRPM: parseInt(e.target.value)})}
                                        className="w-full px-4 py-2 border-2 rounded-lg"
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">Max Feed Rate (mm/min)</label>
                                    <input
                                        type="number"
                                        placeholder="3000"
                                        value={form.maxFeedRate}
                                        onChange={(e) => setForm({...form, maxFeedRate: parseInt(e.target.value)})}
                                        className="w-full px-4 py-2 border-2 rounded-lg"
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">Machine Rigidity</label>
                                    <select
                                        value={form.rigidity}
                                        onChange={(e) => setForm({...form, rigidity: e.target.value})}
                                        className="w-full px-4 py-2 border-2 rounded-lg"
                                    >
                                        <option value="low">Low (Flexible frame)</option>
                                        <option value="medium">Medium (Standard DIY)</option>
                                        <option value="high">High (Solid/Commercial)</option>
                                    </select>
                                </div>
                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">Spindle Type</label>
                                    <select
                                        value={form.spindleType}
                                        onChange={(e) => setForm({...form, spindleType: e.target.value})}
                                        className="w-full px-4 py-2 border-2 rounded-lg"
                                    >
                                        <option value="router">Router</option>
                                        <option value="spindle">Spindle</option>
                                        <option value="dremel">Dremel/Rotary Tool</option>
                                    </select>
                                </div>
                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">Motor Type</label>
                                    <select
                                        value={form.motorType}
                                        onChange={(e) => setForm({...form, motorType: e.target.value})}
                                        className="w-full px-4 py-2 border-2 rounded-lg"
                                    >
                                        <option value="stepper">Stepper</option>
                                        <option value="servo">Servo</option>
                                        <option value="hybrid">Hybrid Stepper</option>
                                    </select>
                                </div>
                            </div>
                            <div className="mt-4 flex gap-3">
                                <button
                                    onClick={handleSubmit}
                                    className="px-8 py-3 bg-green-600 text-white rounded-lg font-semibold"
                                >
                                    {editing ? 'Update' : 'Save'}
                                </button>
                                <button
                                    onClick={() => {
                                        setShowForm(false);
                                        setEditing(null);
                                    }}
                                    className="px-8 py-3 bg-gray-400 text-white rounded-lg"
                                >
                                    Cancel
                                </button>
                            </div>
                        </div>
                    )}

                    <div className="grid md:grid-cols-2 gap-4">
                        {machines.map(m => (
                            <div key={m.id} className="p-4 bg-blue-50 rounded-lg border-2">
                                <div className="flex justify-between items-start mb-3">
                                    <h3 className="text-xl font-bold">{m.name}</h3>
                                    <div className="flex gap-2">
                                        <button onClick={() => handleEdit(m)} className="text-blue-500">
                                            <Edit2 className="w-5 h-5" />
                                        </button>
                                        <button onClick={() => deleteMachine(m.id)} className="text-red-500">
                                            <Trash2 className="w-5 h-5" />
                                        </button>
                                    </div>
                                </div>
                                <div className="text-sm">
                                    <div>Max RPM: {m.maxRPM}</div>
                                    <div>Optimal RPM: {m.optimalRPM}</div>
                                    <div>Max Feed: {m.maxFeedRate} mm/min</div>
                                    <div>Rigidity: {m.rigidity}</div>
                                </div>
                            </div>
                        ))}
                    </div>

                    {machines.length === 0 && !showForm && (
                        <div className="text-center py-12 text-gray-500">
                            <Settings className="w-16 h-16 mx-auto mb-4 opacity-50" />
                            <p>No machines yet. Click "Add Machine" to get started.</p>
                        </div>
                    )}
                </div>
            );
        };

        const BitsTab = ({ bits, addBit, updateBit, deleteBit }) => {
            const [showForm, setShowForm] = useState(false);
            const [editing, setEditing] = useState(null);
            const [form, setForm] = useState({
                name: '', diameter: 6, flutes: 2, length: 25, type: 'endmill', material: 'hss'
            });

            const handleSubmit = () => {
                if (!form.name) return;
                if (editing) {
                    updateBit({ ...form, id: editing.id });
                    setEditing(null);
                } else {
                    addBit(form);
                }
                setForm({ name: '', diameter: 6, flutes: 2, length: 25, type: 'endmill', material: 'hss' });
                setShowForm(false);
            };

            const handleEdit = (b) => {
                setForm(b);
                setEditing(b);
                setShowForm(true);
            };

            return (
                <div>
                    <div className="flex justify-between mb-6">
                        <h2 className="text-2xl font-bold">Cutting Bits</h2>
                        <button
                            onClick={() => setShowForm(!showForm)}
                            className="px-6 py-2 bg-green-600 text-white rounded-lg flex items-center gap-2"
                        >
                            <Plus className="w-5 h-5" />
                            {showForm ? 'Cancel' : 'Add Bit'}
                        </button>
                    </div>

                    {showForm && (
                        <div className="mb-6 p-6 bg-gray-50 rounded-lg">
                            <h3 className="font-bold mb-4">{editing ? 'Edit' : 'Add'} Cutting Bit</h3>
                            <div className="grid md:grid-cols-2 gap-4">
                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">Bit Name/Description *</label>
                                    <input
                                        placeholder="6mm 2-flute endmill"
                                        value={form.name}
                                        onChange={(e) => setForm({...form, name: e.target.value})}
                                        className="w-full px-4 py-2 border-2 rounded-lg"
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">Diameter (mm)</label>
                                    <input
                                        type="number"
                                        step="0.1"
                                        placeholder="6"
                                        value={form.diameter}
                                        onChange={(e) => setForm({...form, diameter: parseFloat(e.target.value)})}
                                        className="w-full px-4 py-2 border-2 rounded-lg"
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">Number of Flutes</label>
                                    <input
                                        type="number"
                                        placeholder="2"
                                        value={form.flutes}
                                        onChange={(e) => setForm({...form, flutes: parseInt(e.target.value)})}
                                        className="w-full px-4 py-2 border-2 rounded-lg"
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">Cutting Length (mm)</label>
                                    <input
                                        type="number"
                                        placeholder="25"
                                        value={form.length}
                                        onChange={(e) => setForm({...form, length: parseInt(e.target.value)})}
                                        className="w-full px-4 py-2 border-2 rounded-lg"
                                    />
                                </div>
                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">Bit Type</label>
                                    <select
                                        value={form.type}
                                        onChange={(e) => setForm({...form, type: e.target.value})}
                                        className="w-full px-4 py-2 border-2 rounded-lg"
                                    >
                                        <option value="endmill">End Mill</option>
                                        <option value="ballnose">Ball Nose</option>
                                        <option value="vbit">V-Bit</option>
                                        <option value="surfacing">Surfacing</option>
                                        <option value="drill">Drill</option>
                                    </select>
                                </div>
                                <div>
                                    <label className="block text-sm font-semibold text-gray-700 mb-2">Material</label>
                                    <select
                                        value={form.material}
                                        onChange={(e) => setForm({...form, material: e.target.value})}
                                        className="w-full px-4 py-2 border-2 rounded-lg"
                                    >
                                        <option value="hss">HSS (High Speed Steel)</option>
                                        <option value="carbide">Carbide</option>
                                        <option value="coated">Coated Carbide</option>
                                    </select>
                                </div>
                            </div>
                            <div className="mt-4 flex gap-3">
                                <button
                                    onClick={handleSubmit}
                                    className="px-8 py-3 bg-green-600 text-white rounded-lg font-semibold"
                                >
                                    {editing ? 'Update' : 'Save'}
                                </button>
                                <button
                                    onClick={() => {
                                        setShowForm(false);
                                        setEditing(null);
                                    }}
                                    className="px-8 py-3 bg-gray-400 text-white rounded-lg"
                                >
                                    Cancel
                                </button>
                            </div>
                        </div>
                    )}

                    <div className="grid md:grid-cols-3 gap-4">
                        {bits.map(b => (
                            <div key={b.id} className="p-4 bg-green-50 rounded-lg border-2">
                                <div className="flex justify-between items-start mb-3">
                                    <h3 className="text-lg font-bold">{b.name}</h3>
                                    <div className="flex gap-2">
                                        <button onClick={() => handleEdit(b)} className="text-blue-500">
                                            <Edit2 className="w-4 h-4" />
                                        </button>
                                        <button onClick={() => deleteBit(b.id)} className="text-red-500">
                                            <Trash2 className="w-4 h-4" />
                                        </button>
                                    </div>
                                </div>
                                <div className="text-sm space-y-1">
                                    <div>Diameter: {b.diameter}mm</div>
                                    <div>Flutes: {b.flutes}</div>
                                    <div>Length: {b.length}mm</div>
                                    <div>Type: {b.type}</div>
                                    <div>Material: {b.material.toUpperCase()}</div>
                                </div>
                            </div>
                        ))}
                    </div>

                    {bits.length === 0 && !showForm && (
                        <div className="text-center py-12 text-gray-500">
                            <Database className="w-16 h-16 mx-auto mb-4 opacity-50" />
                            <p>No bits yet. Click "Add Bit" to get started.</p>
                        </div>
                    )}
                </div>
            );
        };

        ReactDOM.render(<App />, document.getElementById('root'));
    </script>
</body>
</html>